# ğŸ›¡ï¸ AIè¯­éŸ³æ”¿æ²»é£é™©ç›‘æ§ç³»ç»Ÿ - å®‰å…¨å¼ºåŒ–é…ç½®
# å…¨æ–¹ä½å®‰å…¨é˜²æŠ¤å’Œå¨èƒæ£€æµ‹

security:
  # ğŸ” èº«ä»½è®¤è¯å’Œæˆæƒ
  authentication:
    # JWTé…ç½®
    jwt:
      secret_key: ${JWT_SECRET_KEY}
      algorithm: "HS256"
      access_token_expire_minutes: 30
      refresh_token_expire_days: 7
      issuer: "audio-ai-system"
      audience: "audio-ai-users"
    
    # å¤šå› ç´ è®¤è¯ (2FA)
    two_factor:
      enabled: true
      issuer_name: "AI Audio Risk Monitor"
      totp_validity_window: 30
      backup_codes_count: 10
    
    # OAuth 2.0 é›†æˆ
    oauth:
      google:
        client_id: ${GOOGLE_CLIENT_ID}
        client_secret: ${GOOGLE_CLIENT_SECRET}
        redirect_uri: "/auth/google/callback"
      
      microsoft:
        client_id: ${MICROSOFT_CLIENT_ID}
        client_secret: ${MICROSOFT_CLIENT_SECRET}
        redirect_uri: "/auth/microsoft/callback"
    
    # å¯†ç ç­–ç•¥
    password_policy:
      min_length: 12
      require_uppercase: true
      require_lowercase: true
      require_numbers: true
      require_special_chars: true
      max_age_days: 90
      history_count: 12
      
  # ğŸš« è®¿é—®æ§åˆ¶
  access_control:
    # åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ (RBAC)
    rbac:
      roles:
        admin:
          permissions:
            - "system:*"
            - "user:*"
            - "audio:*"
            - "model:*"
            - "config:*"
        
        analyst:
          permissions:
            - "audio:read"
            - "audio:analyze"
            - "report:read"
            - "report:create"
        
        operator:
          permissions:
            - "audio:upload"
            - "audio:read"
            - "task:read"
        
        viewer:
          permissions:
            - "audio:read"
            - "report:read"
    
    # IPç™½åå•
    ip_whitelist:
      enabled: false
      allowed_ips:
        - "192.168.1.0/24"
        - "10.0.0.0/8"
        - "172.16.0.0/12"
    
    # APIé™æµ
    rate_limiting:
      global:
        requests_per_minute: 1000
        requests_per_hour: 10000
      
      per_user:
        requests_per_minute: 100
        requests_per_hour: 1000
      
      upload:
        files_per_hour: 50
        max_file_size_mb: 100
  
  # ğŸ” å¨èƒæ£€æµ‹
  threat_detection:
    # å¼‚å¸¸è¡Œä¸ºæ£€æµ‹
    anomaly_detection:
      enabled: true
      
      # ç™»å½•å¼‚å¸¸
      login_anomalies:
        max_failed_attempts: 5
        lockout_duration_minutes: 30
        unusual_location_threshold: 1000  # km
        unusual_time_threshold: 6  # hours outside normal pattern
      
      # ä½¿ç”¨æ¨¡å¼å¼‚å¸¸
      usage_anomalies:
        max_requests_per_minute: 200
        unusual_upload_pattern_threshold: 0.8
        suspicious_file_types: [".exe", ".bat", ".sh", ".ps1"]
    
    # æ¶æ„æ–‡ä»¶æ£€æµ‹
    malware_detection:
      enabled: true
      scan_uploads: true
      quarantine_suspicious: true
      
      # æ–‡ä»¶ç±»å‹æ£€æŸ¥
      allowed_extensions: [".wav", ".mp3", ".flac", ".m4a", ".aac", ".ogg"]
      max_file_size_mb: 100
      
      # ç—…æ¯’æ‰«æ
      antivirus:
        engine: "clamav"
        update_signatures: true
        scan_timeout_seconds: 300
    
    # ç½‘ç»œå®‰å…¨
    network_security:
      # DDoSé˜²æŠ¤
      ddos_protection:
        enabled: true
        threshold_requests_per_second: 100
        block_duration_minutes: 60
      
      # SQLæ³¨å…¥é˜²æŠ¤
      sql_injection_protection:
        enabled: true
        patterns:
          - "union.*select"
          - "drop.*table"
          - "insert.*into"
          - "delete.*from"
      
      # XSSé˜²æŠ¤
      xss_protection:
        enabled: true
        content_security_policy: "default-src 'self'; script-src 'self' 'unsafe-inline'"
  
  # ğŸ”’ æ•°æ®åŠ å¯†
  encryption:
    # ä¼ è¾“åŠ å¯†
    transport:
      tls_version: "1.3"
      cipher_suites:
        - "TLS_AES_256_GCM_SHA384"
        - "TLS_CHACHA20_POLY1305_SHA256"
        - "TLS_AES_128_GCM_SHA256"
      
      # HSTSé…ç½®
      hsts:
        enabled: true
        max_age_seconds: 31536000
        include_subdomains: true
        preload: true
    
    # é™æ€æ•°æ®åŠ å¯†
    data_at_rest:
      algorithm: "AES-256-GCM"
      key_rotation_days: 90
      
      # æ•°æ®åº“åŠ å¯†
      database:
        encrypt_connections: true
        encrypt_backups: true
        field_level_encryption:
          - "user_personal_info"
          - "audio_transcripts"
          - "analysis_results"
      
      # æ–‡ä»¶ç³»ç»ŸåŠ å¯†
      filesystem:
        encrypt_uploads: true
        encrypt_cache: true
        encrypt_logs: false  # æ—¥å¿—å¯èƒ½éœ€è¦å®æ—¶åˆ†æ
  
  # ğŸ“Š å®‰å…¨å®¡è®¡
  audit:
    # æ—¥å¿—è®°å½•
    logging:
      enabled: true
      level: "INFO"
      
      # å®¡è®¡äº‹ä»¶
      events:
        - "user_login"
        - "user_logout"
        - "permission_change"
        - "file_upload"
        - "file_download"
        - "api_access"
        - "admin_action"
        - "security_alert"
      
      # æ—¥å¿—ä¿ç•™
      retention:
        security_logs_days: 365
        access_logs_days: 90
        error_logs_days: 180
    
    # åˆè§„æ€§
    compliance:
      # GDPR
      gdpr:
        enabled: true
        data_retention_days: 730
        anonymization_enabled: true
        right_to_be_forgotten: true
      
      # SOC 2
      soc2:
        enabled: true
        continuous_monitoring: true
        automated_reports: true
  
  # ğŸš¨ äº‹ä»¶å“åº”
  incident_response:
    # è‡ªåŠ¨å“åº”
    automated_response:
      enabled: true
      
      # è´¦æˆ·é”å®š
      account_lockout:
        trigger: "multiple_failed_logins"
        duration_minutes: 30
        notification: true
      
      # IPå°ç¦
      ip_blocking:
        trigger: "suspicious_activity"
        duration_minutes: 60
        whitelist_bypass: false
      
      # æœåŠ¡éš”ç¦»
      service_isolation:
        trigger: "security_breach"
        isolate_affected_nodes: true
        maintain_core_services: true
    
    # é€šçŸ¥æœºåˆ¶
    notifications:
      channels:
        email:
          enabled: true
          recipients: ["security@company.com"]
          severity_threshold: "medium"
        
        slack:
          enabled: true
          webhook_url: ${SLACK_WEBHOOK_URL}
          channel: "#security-alerts"
          severity_threshold: "high"
        
        sms:
          enabled: false
          provider: "twilio"
          numbers: ["+1234567890"]
          severity_threshold: "critical"
  
  # ğŸ”§ å®‰å…¨é…ç½®
  hardening:
    # ç³»ç»Ÿå¼ºåŒ–
    system:
      disable_unnecessary_services: true
      remove_default_accounts: true
      secure_boot_enabled: true
      
      # æ–‡ä»¶æƒé™
      file_permissions:
        config_files: "600"
        log_files: "640"
        executable_files: "755"
        data_directories: "750"
    
    # åº”ç”¨å¼ºåŒ–
    application:
      disable_debug_mode: true
      remove_development_endpoints: true
      secure_headers: true
      
      # HTTPå®‰å…¨å¤´
      security_headers:
        x_content_type_options: "nosniff"
        x_frame_options: "DENY"
        x_xss_protection: "1; mode=block"
        strict_transport_security: "max-age=31536000; includeSubDomains"
        content_security_policy: "default-src 'self'"
    
    # ç½‘ç»œå¼ºåŒ–
    network:
      disable_unnecessary_ports: true
      configure_firewall: true
      enable_intrusion_detection: true
      
      # é˜²ç«å¢™è§„åˆ™
      firewall_rules:
        - name: "allow_http"
          port: 80
          protocol: "tcp"
          source: "any"
        
        - name: "allow_https"
          port: 443
          protocol: "tcp"
          source: "any"
        
        - name: "allow_ssh"
          port: 22
          protocol: "tcp"
          source: "management_network"
        
        - name: "deny_all"
          action: "deny"
          source: "any"
          destination: "any"

# ğŸ” å®‰å…¨ç›‘æ§ä»ªè¡¨æ¿é…ç½®
monitoring:
  metrics:
    - name: "failed_login_attempts"
      type: "counter"
      description: "å¤±è´¥ç™»å½•å°è¯•æ¬¡æ•°"
    
    - name: "suspicious_file_uploads"
      type: "counter"
      description: "å¯ç–‘æ–‡ä»¶ä¸Šä¼ æ¬¡æ•°"
    
    - name: "security_alerts_generated"
      type: "counter"
      description: "ç”Ÿæˆçš„å®‰å…¨è­¦æŠ¥æ•°é‡"
    
    - name: "blocked_ip_addresses"
      type: "gauge"
      description: "å½“å‰è¢«å°ç¦çš„IPåœ°å€æ•°é‡"
    
    - name: "active_security_sessions"
      type: "gauge"
      description: "å½“å‰æ´»è·ƒçš„å®‰å…¨ä¼šè¯æ•°é‡"
